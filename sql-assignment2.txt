--1)
SELECT C.COUNTRYNAME, CONT.CONTINENT
FROM COUNTRIES C
JOIN CONTINENTS CONT ON C.CONTINENT = CONT.CONTID
ORDER BY CONT.CONTINENT;

--2)
SELECT CONT.CONTINENT, COUNT(C.COUNTRYID) 
FROM CONTINENTS CONT
LEFT JOIN COUNTRIES C ON C.CONTINENT = CONT.CONTID
GROUP BY CONT.CONTINENT;

--3)
SELECT C.COUNTRYNAME
FROM COUNTRIES C
LEFT JOIN CAR_MAKERS CM ON C.COUNTRYID = CM.COUNTRY
WHERE CM.ID IS NULL;

--4)
SELECT C.COUNTRYNAME, CM.FULLNAME
FROM COUNTRIES C
LEFT JOIN CAR_MAKERS CM ON CM.COUNTRY = C.COUNTRYID
WHERE CM.COUNTRY = 4;

--5)
SELECT C.COUNTRYNAME, CM.FULLNAME
FROM COUNTRIES C
LEFT JOIN CAR_MAKERS CM ON CM.COUNTRY = C.COUNTRYID
WHERE CM.COUNTRY = 1 OR CM.COUNTRY = 3;

--6)
SELECT CM.MAKER, C.COUNTRYNAME, CO.CONTINENT
FROM CAR_MAKERS CM
JOIN COUNTRIES C ON CM.COUNTRY = C.COUNTRYID
JOIN CONTINENTS CO ON C.CONTINENT = CO.CONTID
WHERE CM.MAKER = 'VOLVO';

--7)
SELECT CM.FULLNAME, MD.MODEL
FROM MODEL_DETAILS MD
JOIN CAR_MAKERS CM ON MD.MAKER = CM.ID
WHERE CM.FULLNAME = 'FORD MOTOR COMPANY';

--8)
SELECT C.COUNTRYNAME, COUNT(MD.MODELID) 
FROM CAR_MAKERS CM
JOIN COUNTRIES C ON CM.COUNTRY = C.COUNTRYID
JOIN MODEL_DETAILS MD ON CM.ID = MD.MAKER
WHERE C.COUNTRYNAME = 'GERMANY'
GROUP BY C.COUNTRYNAME;

--9)
SELECT C.COUNTRYNAME, MD.MODEL, CM.FULLNAME, CM.ID 
FROM CAR_MAKERS CM
JOIN COUNTRIES C ON CM.COUNTRY = C.COUNTRYID
JOIN MODEL_DETAILS MD ON CM.ID = MD.MAKER
WHERE C.COUNTRYNAME = 'JAPAN';

--10)
SELECT
MIN(CD.MPG) AS MIN_MPG, MAX(CD.MPG) AS MAX_MPG,
MIN(CD.CYLINDERS) AS MIN_CYLINDERS, MAX(CD.CYLINDERS) AS MAX_CYLINDERS,
MIN(CD.EDISPL) AS MIN_EDISPL, MAX(CD.EDISPL) AS MAX_EDISPL,
MIN(CD.HORSEPOWER) AS MIN_HORSEPOWER, MAX(CD.HORSEPOWER) AS MAX_HORSEPOWER,
MIN(CD.WEIGHT) AS MIN_WEIGHT, MAX(CD.WEIGHT) AS MAX_WEIGHT,
MIN(CD.ACCEL) AS MIN_ACCEL, MAX(CD.ACCEL) AS MAX_ACCEL,
CM.FULLNAME, CY.COUNTRYNAME, CT.CONTINENT
FROM CAR_DETAILS CD 
LEFT JOIN CAR_NAMES CN 
ON CD.ID = CN.ID 
LEFT JOIN MODEL_DETAILS MD 
ON CN.MODEL = MD.MODEL 
LEFT JOIN CAR_MAKERS CM 
ON MD.MAKER = CM.ID 
LEFT JOIN COUNTRIES CY 
ON CM.COUNTRY = CY.COUNTRYID 
LEFT JOIN CONTINENTS CT 
ON CY.CONTINENT = CT.CONTID
GROUP BY  
GROUPING SETS (
(CN.MODEL, CM.FULLNAME, CY.COUNTRYNAME, CT.CONTINENT),
()
);

--11)
SELECT YEAR, COUNT(*) AS TOTAL_CARS
FROM CAR_DETAILS C
GROUP BY YEAR
ORDER BY TOTAL_CARS DESC;

--12)
SELECT YEAR, COUNT(*) 
FROM CAR_DETAILS C
GROUP BY YEAR
ORDER BY 2 ASC;

--13)
-----A) MPG
SELECT YEAR, MIN(MPG), MAX(MPG), AVG(MPG) 
FROM CAR_DETAILS
GROUP BY YEAR
ORDER BY 1;

-----B) CYLINDERS
SELECT YEAR, MIN(CYLINDERS), MAX(CYLINDERS), AVG(CYLINDERS) 
FROM CAR_DETAILS
GROUP BY YEAR
ORDER BY 1;

-----C) EDISPL
SELECT YEAR, MIN(EDISPL), MAX(EDISPL), AVG(EDISPL) 
FROM CAR_DETAILS
GROUP BY YEAR
ORDER BY 1;

-----D) HORSEPOWER
SELECT YEAR, MIN(HORSEPOWER), MAX(HORSEPOWER), AVG(HORSEPOWER) 
FROM CAR_DETAILS
GROUP BY YEAR
ORDER BY 1;

-----E) WEIGHT
SELECT YEAR, MIN(WEIGHT), MAX(WEIGHT), AVG(WEIGHT) 
FROM CAR_DETAILS
GROUP BY YEAR
ORDER BY 1;

-----F) ACCEL
SELECT YEAR, MIN(ACCEL), MAX(ACCEL), AVG(ACCEL) 
FROM CAR_DETAILS
GROUP BY YEAR
ORDER BY 1;

--14)
--CALCULATION FOR HORSEPOWER
SELECT AVG(HORSEPOWER), MEDIAN(HORSEPOWER), STDDEV(HORSEPOWER) 
FROM CAR_DETAILS;

--CALCULATION FOR WEIGHT
SELECT AVG(WEIGHT), MEDIAN(WEIGHT), STDDEV(WEIGHT) 
FROM CAR_DETAILS;

--CALCULATION FOR ACCEL
SELECT AVG(ACCEL), MEDIAN(ACCEL), STDDEV(ACCEL) 
FROM CAR_DETAILS;
